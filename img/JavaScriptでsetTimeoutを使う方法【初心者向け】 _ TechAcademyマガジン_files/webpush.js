!function(e){function t(i){if(r[i])return r[i].exports;var o=r[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(exports,e,r){t.o(exports,e)||Object.defineProperty(exports,e,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=46)}({10:function(e,t,r){"use strict";t.a=new(function(){function e(e){this.prefix=e}return e.prototype.log=function(e,t){},e}())("LOG")},11:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i=function(){function e(){this.defaultOption={credentials:"include",headers:{"content-type":"application/json;charset=utf-8"},method:"post",mode:"cors"}}return e.prototype.fetch=function(e,t){var r=this;return new Promise(function(i,o){if(window.fetch)return window.fetch(e,Object.assign({},r.defaultOption,t)).then(function(e){if(r.isErrorResponse(e))return void o(e);i(e)},function(e){o(e)});o("self.fetch is not supported")})},e.prototype.isErrorResponse=function(e){return!e||e&&!e.ok},e}()},46:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(10),o=r(11);i.a.prefix="PushSubscriber";var n=new o.a,s=function(){function e(e){var t=e.workerName,r=e.workerPath,o=e.publicKey,n=e.register,s=e.unregister,u=e.isAutoOptIn,a=e.cookieName,c=e.gidKey;if(!this.IsSupportedBrowser())return void i.a.log("not a supported browser");this.workerName=t,this.workerPath=r,this.publicKey=o,this.apiEndpoints={register:n,unregister:s},this.isAutoOptIn=u,this.cookieName=a,this.gidKey=c,this.initiator=location.href,this.referrer=document.referrer,this.convertedVapIdKey=this._urlBase64ToUint8Array(this.publicKey)}return e.prototype.IsSupportedBrowser=function(){return window.localStorage&&window.fetch&&window.Promise&&window.navigator.serviceWorker},Object.defineProperty(e.prototype,"isPushSubscriber",{get:function(){return window.localStorage?"true"===window.localStorage.getItem("ma.isPushSubscriber"):this._isPushSubscriber},set:function(e){this._isPushSubscriber=e,window.localStorage&&window.localStorage.setItem("ma.isPushSubscriber",String(e))},enumerable:!0,configurable:!0}),e.prototype._getRegistration=function(){var e=this;return new Promise(function(t,r){"serviceWorker"in navigator?window.navigator.serviceWorker.getRegistration(e.workerPath).then(function(e){t(e)},function(e){r(e)}):r("worker is not supported")})},e.prototype._urlBase64ToUint8Array=function(e){for(var t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),i=self.atob(r),o=new Uint8Array(i.length),n=0;n<i.length;++n)o[n]=i.charCodeAt(n);return o},e.prototype.LoadSubscription=function(){var e=this;return new Promise(function(t,r){e._getRegistration().then(function(e){if(e&&e instanceof ServiceWorkerRegistration)return e.pushManager.permissionState({userVisibleOnly:!0});var t="push registration info is null";i.a.log(t),r(t)},function(e){var t="failed to get worker registration";i.a.log(t,e),r(t)}).then(function(o){if(o){switch(o.toLowerCase()){case"prompt":if(!e.isPushSubscriber&&e.isAutoOptIn)return e.SubscribeNotification().then(function(){i.a.log("succeeded to auto subscribe"),t(e.isPushSubscriber)},function(r){i.a.log("failed to auto subscribe",r),t(e.isPushSubscriber)});e.isPushSubscriber=!1;break;case"denied":e.isPushSubscriber&&e.UnsubscribeNotification(),e.isPushSubscriber=!1}t(e.isPushSubscriber)}else{var n="push permission state is null";i.a.log(n),r(n)}},function(e){var t="failed to get push permission state";i.a.log(t,e),r(t)})})},e.prototype.SubscribeNotification=function(){var e=this;return new Promise(function(t,r){"serviceWorker"in window.navigator?(i.a.log("worker is supported"),window.navigator.serviceWorker.register(e.workerPath+e.workerName).then(function(e){return i.a.log("registered"),window.navigator.serviceWorker.ready},function(e){i.a.log("failed to worker registration",e),r(e)}).then(function(t){if(t instanceof ServiceWorkerRegistration)return t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e.convertedVapIdKey})}).then(function(o){if(i.a.log("succeeded to subscribe"),o){e.isPushSubscriber=!0;var s=o.toJSON(),u={body:JSON.stringify({initiator:e.initiator,endpoint:s.endpoint,auth:s.keys.auth,p256dh:s.keys.p256dh,referrer:e.referrer})};return t(o),n.fetch(e.apiEndpoints.register,u)}i.a.log("subscription is null"),r()},function(e){i.a.log("failed to push subscribe",e),r(e)}).then(function(){i.a.log("succeeded to send subscription")},function(e){i.a.log("failed to send subscription",e)})):(i.a.log("worker is not supported"),r())})},e.prototype.UnsubscribeNotification=function(){var e=this;return new Promise(function(t,r){e._getRegistration().then(function(e){if(e)return e.getNotifications()},function(e){i.a.log("failed to get worker registration",e)}).then(function(t){var r={body:"{}"};if(t&&t.length>0){var i=t.sort(function(e,t){return e.timestamp.getTime()-t.timestamp.getTime()})[0];r.body=JSON.stringify({tag:i.tag})}return n.fetch(e.apiEndpoints.unregister,r)},function(e){i.a.log("failed to get notifications",e)}).then(function(r){i.a.log("succeeded to unsubscribe"),e.isPushSubscriber=!1,t()},function(e){i.a.log("failed to unsubscribe",e),r(e)})})},e}(),u=new s({cookieName:"___gid",gidKey:"gid",isAutoOptIn:"true"==="true".toLowerCase(),publicKey:"BLpG_y_xzLq1tcjJ-yw9-vmKYi0xreRZcWIIaWeuqluzaLMqhCBWFDf_frhcmWGjz8bFniZjndVhFxqExX1_VlU",register:"https://log.ma-jin.jp/web_push/194/register?gid=184f359fb00981030ff023302ad1d2ec",unregister:"https://log.ma-jin.jp/web_push/194/unregister?gid=184f359fb00981030ff023302ad1d2ec",workerName:"pushworker.js",workerPath:"/"});u.LoadSubscription().then(function(){},function(e){u.isAutoOptIn&&u.SubscribeNotification()}),window.ma?window.ma.push=u:window.ma={push:u}}});